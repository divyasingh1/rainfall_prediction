data<-read.csv("aeon_stock.csv.csv")
library(dplyr)
library(forecast)
library(tseries)
library(reshape)
str(data)
head(data)
data<-filter(data,SD_Name=="EI_AELKO14")
data<-filter(data,col1=="stocks")
data<-filter(data,col1=="stocks_p")

head(data)
traindata<-filter(data,YEAR<=2012)
tail(traindata)
traindata<-select(traindata,YEAR:DEC)
head(traindata)
traindata<-filter(data,YEAR<=2012)
tail(traindata)
traindata<-select(traindata,YEAR:DEC)
head(traindata)
traindata<-melt(traindata,c("YEAR"))
head(traindata)
traindata<-arrange(traindata,YEAR)
head(traindata,13)
tail(traindata,13)
traindata<-ts(traindata$value,frequency = 12)
#plot(decompose(traindata))
head(traindata,13)
adf.test(traindata,alternative = "stationary")
class(traindata)
acf(traindata)
pacf(traindata)
acf(diff(diff(traindata)))
pacf(diff(diff(traindata)))
model<-arima(traindata,order=c(0,0,0),seasonal = list(order=c(2,0,0),period=12))
accuracy(model)
tsdiag(model)
predicted<-forecast(model,h=12)
names(predicted)
plot(predicted,xlim=c(61,64))
testdata<-filter(data,YEAR<=2013)
head(testdata)
testdata<-select(testdata,YEAR:DEC)
testdata<-melt(testdata,c("YEAR"))
head(testdata)
testdata<-arrange(testdata,YEAR)
tail(testdata,13)
testdata<-ts(testdata$value,frequency=12)
head(testdata)
plot(predicted,xlim=c(50,70))
lines(testdata,col='red',type='l')

#write.csv(predcicted,"model1.csv")